GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
<class 'monai.transforms.utility.array.AddChannel'>: Class `AddChannel` has been deprecated since version 0.8. please use MetaTensor data type and monai.transforms.EnsureChannelFirst instead.




































































Loading dataset:  67%|██████████████████████████████████████████████████████████████▏                              | 613/916 [03:04<01:31,  3.31it/s]
Traceback (most recent call last):
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/nibabel/loadsave.py", line 90, in load
    stat_result = os.stat(filename)
FileNotFoundError: [Errno 2] No such file or directory: '/home/GRAMES.POLYMTL.CA/lobouz/duke/projects/ivadomed/contrast-agnostic-seg/data_processed_sg_2023-03-10_NO_CROP/data_processed_clean/derivatives/labels/sub-beijingVerio01/dwi/sub-beijingVerio01_rec-average_dwi_seg-manual.nii.gz'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/transforms/transform.py", line 102, in apply_transform
    return _apply_transform(transform, data, unpack_items)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/transforms/transform.py", line 66, in _apply_transform
    return transform(parameters)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/transforms/io/dictionary.py", line 154, in __call__
    data = self._loader(d[key], reader)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/transforms/io/array.py", line 247, in __call__
    img = reader.read(filename)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/data/image_reader.py", line 927, in read
    img = nib.load(name, **kwargs_)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/nibabel/loadsave.py", line 92, in load
    raise FileNotFoundError(f"No such file or no access: '{filename}'")
FileNotFoundError: No such file or no access: '/home/GRAMES.POLYMTL.CA/lobouz/duke/projects/ivadomed/contrast-agnostic-seg/data_processed_sg_2023-03-10_NO_CROP/data_processed_clean/derivatives/labels/sub-beijingVerio01/dwi/sub-beijingVerio01_rec-average_dwi_seg-manual.nii.gz'
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "monai_main.py", line 382, in <module>
    main(args)
  File "monai_main.py", line 311, in main
    trainer.fit(pl_model)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 609, in fit
    self, self._fit_impl, model, train_dataloaders, val_dataloaders, datamodule, ckpt_path
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/call.py", line 36, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 88, in launch
    return function(*args, **kwargs)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 650, in _fit_impl
    self._run(model, ckpt_path=self.ckpt_path)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 1042, in _run
    self._data_connector.prepare_data()
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/connectors/data_connector.py", line 115, in prepare_data
    self.trainer._call_lightning_module_hook("prepare_data")
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py", line 1356, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "monai_main.py", line 113, in prepare_data
    self.train_ds = CacheDataset(data=datalist, transform=train_transforms, cache_rate=1.0, num_workers=8)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/data/dataset.py", line 814, in __init__
    self.set_data(data)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/data/dataset.py", line 841, in set_data
    self._cache = self._fill_cache(indices)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/data/dataset.py", line 870, in _fill_cache
    return list(tqdm(p.imap(self._load_cache_item, indices), total=len(indices), desc="Loading dataset"))
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/multiprocessing/pool.py", line 748, in next
    raise value
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/multiprocessing/pool.py", line 121, in worker
    result = (True, func(*args, **kwds))
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/data/dataset.py", line 884, in _load_cache_item
    item = apply_transform(_xform, item)
  File "/home/GRAMES.POLYMTL.CA/lobouz/miniconda3/envs/monai-env/lib/python3.7/site-packages/monai/transforms/transform.py", line 129, in apply_transform
    raise RuntimeError(f"applying transform {transform}") from e
RuntimeError: applying transform <monai.transforms.io.dictionary.LoadImaged object at 0x7fb514341e90>